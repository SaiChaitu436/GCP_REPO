{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-11-04T12:22:15.628400Z", "invocation_id": "bf2aa9d3-cc9a-44a0-a1e5-375cb1e79818", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:23.406018Z", "completed_at": "2024-11-04T12:21:23.409845Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:23.409845Z", "completed_at": "2024-11-04T12:21:25.942604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.537719488143921, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "2abe0fd6-384e-4ae7-81f6-a1a1699d7743", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_all_columns", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT\r\r\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\r\r\n    FROM\r\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries\r\r\n),\r\r\n\r\r\nflatten_payload AS (\r\r\n    SELECT\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\r\r\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\r\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\r\r\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\r\r\n    FROM\r\r\n        source_data\r\r\n),\r\r\n\r\r\nflattened_payload AS (\r\r\n    SELECT\r\r\n        EventTime,\r\r\n        ApplicationId,\r\r\n        NotificationId,\r\r\n        PublishTime,\r\r\n        SubscriptionId,\r\r\n        NotificationType,\r\r\n        NotificationVersion,\r\r\n        ASIN,\r\r\n        ItemCondition,\r\r\n        MarketplaceId,\r\r\n        OfferChangeType,\r\r\n        TimeOfOfferChange,\r\r\n\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\r\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\r\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\r\r\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\r\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\r\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\r\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\r\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\r\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\r\r\n\r\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\r\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\r\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\r\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\r\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\r\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\r\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\r\r\n\r\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\r\r\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\r\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\r\r\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\r\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\r\r\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\r\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\r\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\r\r\n\r\r\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\r\r\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\r\r\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\r\r\n\r\r\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\r\r\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\r\r\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\r\r\n\r\r\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\r\r\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\r\r\n\r\r\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\r\r\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\r\r\n\r\r\n    FROM\r\r\n        flatten_payload,\r\r\n        UNNEST(offers) AS offer,\r\r\n        UNNEST(bbp) AS bbp,\r\r\n        UNNEST(lop) AS lop,\r\r\n        UNNEST(neo) AS neo,\r\r\n        UNNEST(noo) AS noo,\r\r\n        UNNEST(sr) AS sr\r\r\n)\r\r\n\r\r\nSELECT *\r\r\nFROM flattened_payload", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:25.946735Z", "completed_at": "2024-11-04T12:21:25.949754Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:25.949754Z", "completed_at": "2024-11-04T12:21:30.915407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.969180107116699, "adapter_response": {"_message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 44, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "ee81082f-d211-46c7-a98e-24a704e16049", "slot_ms": 7230}, "message": "CREATE TABLE (44.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_buybox_offers", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT \r\r\n        PARSE_JSON(data.message_body) AS raw_data,\r\r\n    FROM \r\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers) AS numberOfOffers,\r\r\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers) AS buyboxprices\r\r\n    FROM source_data\r\r\n),\r\r\nflatten_data_1 AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(bop.Condition)AS EligibleOfferCondition,\r\r\n        JSON_VALUE(bop.FulfillmentChannel)AS EligibleFulFillmentChannel,\r\r\n        JSON_VALUE(bop.OfferCount)AS EligibleOfferCount,\r\r\n\r\r\n        JSON_VALUE(noo.Condition)AS NumberOfferCondition,\r\r\n        JSON_VALUE(noo.FulfillmentChannel)AS NumberFulFillmentChannel,\r\r\n        JSON_VALUE(noo.OfferCount)AS NumberOfferCount\r\r\n    FROM flatten_data,\r\r\n        UNNEST(buyboxprices) AS bop,\r\r\n        UNNEST(numberOfOffers) AS noo\r\r\n)\r\r\n\r\r\nSELECT * FROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_buybox_offers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:30.915407Z", "completed_at": "2024-11-04T12:21:30.915407Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:30.915407Z", "completed_at": "2024-11-04T12:21:35.824485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.9090776443481445, "adapter_response": {"_message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 28, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "a2ad79fb-0b82-475c-8ece-87712d3e9f6f", "slot_ms": 4013}, "message": "CREATE TABLE (28.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_notification_lowest_prices", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT \r\r\n        PARSE_JSON(data.message_body) AS raw_data,\r\r\n    FROM \r\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\r\r\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.LowestPrices) AS lowestPrices\r\r\n    FROM source_data\r\r\n),\r\r\nflatten_data_1 AS (\r\r\n    SELECT\r\r\n        NotificationId,\r\r\n        JSON_VALUE(lp.Condition)AS Condition,\r\r\n        JSON_VALUE(lp.FulfillmentChannel)AS FulFillmentChannel,\r\r\n\r\r\n        JSON_VALUE(lp.LandedPrice.Amount)AS LandedPriceAmount,\r\r\n        JSON_VALUE(lp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\r\r\n\r\r\n        JSON_VALUE(lp.ListingPrice.Amount)AS ListingPriceAmount,\r\r\n        JSON_VALUE(lp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\r\r\n\r\r\n        JSON_VALUE(lp.Shipping.Amount)AS ShippingCost,\r\r\n    FROM flatten_data,\r\r\n        UNNEST(lowestPrices) AS lp\r\r\n)\r\r\n\r\r\nSELECT * FROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_lowest_prices`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:35.824485Z", "completed_at": "2024-11-04T12:21:35.824485Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:35.824485Z", "completed_at": "2024-11-04T12:21:40.948246Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.123761177062988, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "fc30b6d2-f2f6-4824-a40c-5386fa4ed7db", "slot_ms": 6024}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_notification_summary", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT \r\r\n        PARSE_JSON(data.message_body) AS raw_data,\r\r\n    FROM \r\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\r\r\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.Summary.ListPrice.Amount) AS ListPriceAmount,\r\r\n        JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices) AS buyboxprice\r\r\n\r\r\n    FROM source_data\r\r\n),\r\r\nflatten_data_1 AS (\r\r\n    SELECT\r\r\n        NotificationId,\r\r\n        JSON_VALUE(bp.LandedPrice.Amount)AS LandedPriceAmount,\r\r\n        JSON_VALUE(bp.LandedPrice.CurrencyCode)AS LandedPriceCurrencyCode,\r\r\n\r\r\n        JSON_VALUE(bp.ListingPrice.Amount)AS ListingPriceAmount,\r\r\n        JSON_VALUE(bp.ListingPrice.CurrencyCode)AS ListingPriceCurrencyCode,\r\r\n        \r\r\n        JSON_VALUE(bp.Shipping.Amount)AS ShippingCost,\r\r\n        JSON_VALUE(bp.Shipping.CurrencyCode)AS ShippingCurrencyCode,\r\r\n\r\r\n        ListPriceAmount\r\r\n        \r\r\n    FROM flatten_data,\r\r\n        UNNEST(buyboxprice) AS bp\r\r\n)\r\r\n\r\r\nSELECT * FROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_notification_summary`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:40.948246Z", "completed_at": "2024-11-04T12:21:40.948246Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:40.963885Z", "completed_at": "2024-11-04T12:21:45.717745Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.769498586654663, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "5aed77d2-944e-4741-a1c8-ab74673b384d", "slot_ms": 5317}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_notifications", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT \r\r\n        PARSE_JSON(data.message_body) AS raw_data,\r\r\n        PARSE_JSON(data.message_body).Payload AS offer\r\r\n    FROM \r\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\r\r\n        JSON_VALUE(raw_data.NotificationMetadata.ApplicationId) AS ApplicationId,\r\r\n        JSON_VALUE(raw_data.NotificationMetadata.SubscriptionId) AS SubscriptionId,\r\r\n        JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\r\r\n        JSON_VALUE(raw_data.NotificationType) AS NotificationType,\r\r\n        JSON_VALUE(raw_data.NotificationVersion) AS NotificationVersion,\r\r\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\r\r\nFROM source_data\r\r\n)\r\r\n\r\r\nSELECT * FROM flatten_data", "relation_name": "`dbt-437212`.`wellbefore`.`src_notifications`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:45.717745Z", "completed_at": "2024-11-04T12:21:45.741035Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:45.742005Z", "completed_at": "2024-11-04T12:21:50.269866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.552121639251709, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "757a3b5e-e16e-4868-b7bd-8bba0beb2a91", "slot_ms": 5312}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_offer_change_trigger", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT\r\r\n        PARSE_JSON(data.message_body) AS raw_data,\r\r\n        PARSE_JSON(data.message_body).Payload AS offer\r\r\n    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\r\r\n        JSON_VALUE(offer.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition)AS ItemCondition,\r\r\n        JSON_VALUE(raw_data.NotificationMetadata.PublishTime) AS PublishTime,\r\r\n    FROM source_data\r\r\n)\r\r\n \r\r\nSELECT * FROM flatten_data", "relation_name": "`dbt-437212`.`wellbefore`.`src_offer_change_trigger`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:50.274169Z", "completed_at": "2024-11-04T12:21:50.276426Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:50.276426Z", "completed_at": "2024-11-04T12:21:55.251520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.978370666503906, "adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 172, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "fad6546e-5be5-49f1-904c-48f01ae5b584", "slot_ms": 15570}, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_offers", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT \r\r\n        PARSE_JSON(data.message_body) AS raw_data\r\r\n    FROM \r\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries AS data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\r\r\n        JSON_VALUE(raw_data, \"$.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offer\r\r\n    FROM source_data\r\r\n),\r\r\nflatten_data_1 AS (\r\r\n    SELECT\r\r\n        NotificationId,\r\r\n        ROW_NUMBER() OVER (PARTITION BY ASIN ORDER BY NotificationId DESC) AS OfferID,\r\r\n        ASIN,\r\r\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\r\r\n        JSON_VALUE(offer, \"$.IsBuyBoxWinner\") AS IsBuyBoxWinner,\r\r\n        JSON_VALUE(offer, \"$.ListingPrice.Amount\") AS ListingPriceAmount,\r\r\n        JSON_VALUE(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\r\r\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS IsOfferNationalPrime,\r\r\n        JSON_VALUE(offer, \"$.PrimeInformation.IsOfferPrime\") AS PrimeInformation\r\r\n    FROM flatten_data,\r\r\n    UNNEST(offer) AS offer\r\r\n)\r\r\n\r\r\nSELECT * \r\r\nFROM flatten_data_1", "relation_name": "`dbt-437212`.`wellbefore`.`src_offers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:21:55.251520Z", "completed_at": "2024-11-04T12:21:55.267422Z"}, {"name": "execute", "started_at": "2024-11-04T12:21:55.267928Z", "completed_at": "2024-11-04T12:22:01.181039Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.929518222808838, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "16573b35-9151-4c79-a231-080231742384", "slot_ms": 5307}, "message": "CREATE TABLE (20.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_products", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT \r\r\n        PARSE_JSON(data.message_body) AS raw_data,\r\r\n    FROM \r\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN)AS ASIN,\r\r\n        JSON_VALUE(raw_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId)AS MarketplaceId\r\r\n    FROM source_data\r\r\n)\r\r\nSELECT * FROM flatten_data", "relation_name": "`dbt-437212`.`wellbefore`.`src_products`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:22:01.181039Z", "completed_at": "2024-11-04T12:22:01.181039Z"}, {"name": "execute", "started_at": "2024-11-04T12:22:01.196055Z", "completed_at": "2024-11-04T12:22:06.066446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.885407447814941, "adapter_response": {"_message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 43, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "1827ea4c-ce06-42a6-9c8f-d0c992599560", "slot_ms": 5930}, "message": "CREATE TABLE (43.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_sales_ranking", "compiled": true, "compiled_code": "WITH source_data AS (\r\r\n    SELECT \r\r\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification.Summary') AS raw_data,\r\r\n      PARSE_JSON(data.message_body) as parse_data\r\r\n    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_payload AS (\r\r\n    SELECT \r\r\n        JSON_VALUE(parse_data.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN) AS ASIN,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, '$.SalesRankings') AS SalesRankings\r\r\n    FROM source_data\r\r\n),\r\r\nflatten_offers AS (\r\r\n    SELECT \r\r\n        GENERATE_UUID() as SurrogateKey,\r\r\n        ASIN,\r\r\n        JSON_EXTRACT(sr, '$.ProductCategoryId') AS ProductCategoryId,\r\r\n        JSON_EXTRACT(sr, '$.Rank') AS Ranking\r\r\n    FROM flatten_payload, UNNEST(SalesRankings) AS sr \r\r\n)\r\r\nSELECT * FROM flatten_offers", "relation_name": "`dbt-437212`.`wellbefore`.`src_sales_ranking`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:22:06.071190Z", "completed_at": "2024-11-04T12:22:06.075041Z"}, {"name": "execute", "started_at": "2024-11-04T12:22:06.075564Z", "completed_at": "2024-11-04T12:22:10.846287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.7761390209198, "adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 172, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "cbe146ec-7f58-4549-a24f-8b79b13cfec3", "slot_ms": 4772}, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_sellers", "compiled": true, "compiled_code": "-- WITH source_data AS (\r\r\n--     SELECT \r\r\n--         PARSE_JSON(data.message_body) AS raw_data,\r\r\n--     FROM \r\r\n--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n-- ),\r\r\n-- flatten_data AS (\r\r\n--     SELECT\r\r\n--         JSON_VALUE(raw_data.EventTime) AS EventTime,\r\r\n--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers\r\r\n--     FROM source_data\r\r\n-- )\r\r\n-- SELECT\r\r\n--     EventTime,\r\r\n--     JSON_VALUE(offers.SellerId) AS SellerId,\r\r\n--     JSON_VALUE(offers.IsFeaturedMerchant) AS IsFeaturedMerchant,\r\r\n--     JSON_VALUE(offers.SellerId) AS IsFulfilledByAmazon\r\r\n-- FROM\r\r\n--     flatten_data, UNNEST(offers) AS offers\r\r\n\r\r\nWITH source_data AS (\r\r\n    SELECT \r\r\n        PARSE_JSON(data.message_body) AS raw_data\r\r\n    FROM \r\r\n        `dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries` AS data\r\r\n),\r\r\nflatten_data AS (\r\r\n    SELECT\r\r\n        JSON_VALUE(raw_data, \"$.EventTime\") AS EventTime,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers\r\r\n    FROM source_data\r\r\n),\r\r\nflattened_offers AS (\r\r\n    SELECT \r\r\n        EventTime,\r\r\n        JSON_VALUE(offer, \"$.SellerId\") AS SellerId,\r\r\n        JSON_VALUE(offer, \"$.IsFeaturedMerchant\") AS IsFeaturedMerchant,\r\r\n        JSON_VALUE(offer, \"$.IsFulfilledByAmazon\") AS IsFulfilledByAmazon\r\r\n    FROM \r\r\n        flatten_data,\r\r\n        UNNEST(offers) AS offer\r\r\n)\r\r\nSELECT * \r\r\nFROM flattened_offers", "relation_name": "`dbt-437212`.`wellbefore`.`src_sellers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T12:22:10.855395Z", "completed_at": "2024-11-04T12:22:10.855395Z"}, {"name": "execute", "started_at": "2024-11-04T12:22:10.855395Z", "completed_at": "2024-11-04T12:22:15.622312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.76691746711731, "adapter_response": {"_message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 172, "bytes_processed": 123696, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-437212", "job_id": "225b3ef8-ebaa-47bd-bc5a-10f3d6b2c6d0", "slot_ms": 4510}, "message": "CREATE TABLE (172.0 rows, 120.8 KiB processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.src_shipping", "compiled": true, "compiled_code": "-- WITH source_data AS (\r\r\n--     SELECT \r\r\n--         PARSE_JSON(data.message_body) AS raw_data,\r\r\n--     FROM \r\r\n--         dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n-- ),\r\r\n-- flatten_data AS (\r\r\n--     SELECT\r\r\n--         JSON_VALUE(raw_data.NotificationMetadata.NotificationId) AS NotificationId,\r\r\n--         JSON_EXTRACT_ARRAY(raw_data.Payload.AnyOfferChangedNotification.Offers) AS offers\r\r\n--     FROM source_data\r\r\n-- )\r\r\n-- SELECT\r\r\n--     NotificationId,\r\r\n--     JSON_VALUE(offers.Shipping.Amount) AS ShippingAmount,\r\r\n--     JSON_VALUE(offers.Shipping.CurrencyCode) AS ShippingCurrencyCode,\r\r\n--     JSON_VALUE(offers.ShippingTime.AvailabilityType) AS ShippingAvailabilityType,\r\r\n--     JSON_VALUE(offers.ShippingTime.MaximumHours) AS ShippingMaximumHours,\r\r\n--     JSON_VALUE(offers.ShippingTime.MinimumHours) AS ShippingMinimumHours,\r\r\n--     JSON_VALUE(offers.ShipsDomestically) AS ShipsDomestically,\r\r\n-- FROM\r\r\n--     flatten_data, UNNEST(offers) AS offers\r\r\n\r\r\nWITH source_data AS (\r\r\n    SELECT \r\r\n      JSON_EXTRACT(data.message_body, '$.Payload.AnyOfferChangedNotification') AS raw_data,\r\r\n      PARSE_JSON(data.message_body) as parse_data\r\r\n    FROM dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries as data\r\r\n),\r\r\nflatten_payload AS (\r\r\n    SELECT \r\r\n        JSON_VALUE(parse_data.NotificationMetadata.NotificationId) AS NotificationId,\r\r\n        JSON_EXTRACT_ARRAY(raw_data, '$.Offers') AS offers\r\r\n    FROM source_data\r\r\n),\r\r\nflatten_offers AS (\r\r\n    SELECT \r\r\n        GENERATE_UUID() as SurrogateKey,\r\r\n        NotificationId,\r\r\n        JSON_EXTRACT(offer, '$.Shipping.Amount') AS ShippingAmount,\r\r\n        JSON_EXTRACT(offer, '$.Shipping.CurrencyCode') AS ShippingCurrencyCode,\r\r\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailabilityType') AS AvailabilityType,\r\r\n        JSON_EXTRACT(offer, '$.ShippingTime.AvailableDate') AS AvailableDate,\r\r\n        JSON_EXTRACT(offer, '$.ShippingTime.MaximumHours') AS MaximumHours,\r\r\n        JSON_EXTRACT(offer, '$.ShippingTime.MinimumHours') AS MinimumHours,\r\r\n        JSON_EXTRACT(offer, '$.ShipsDomestically') AS ShipsDomestically\r\r\n\r\r\n    FROM flatten_payload, UNNEST(offers) AS offer \r\r\n)\r\r\nSELECT * FROM flatten_offers", "relation_name": "`dbt-437212`.`wellbefore`.`src_shipping`"}], "elapsed_time": 54.92760133743286, "args": {"printer_width": 80, "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "full_refresh": true, "invocation_command": "dbt run --full-refresh", "favor_state": false, "defer": false, "quiet": false, "log_file_max_bytes": 10485760, "strict_mode": false, "partial_parse": true, "enable_legacy_logger": false, "exclude": [], "log_path": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs", "cache_selected_only": false, "require_resource_names_without_spaces": false, "use_colors": true, "which": "run", "send_anonymous_usage_stats": true, "empty": false, "introspect": true, "select": [], "partial_parse_file_diff": true, "project_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1", "indirect_selection": "eager", "log_format_file": "debug", "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "static_parser": true, "vars": {}, "profiles_dir": "C:\\Users\\SAILS-DM204\\.dbt", "version_check": true, "use_colors_file": true, "populate_cache": true, "show_resource_report": false, "print": true, "source_freshness_run_project_hooks": false, "macro_debugging": false, "log_level_file": "debug"}}