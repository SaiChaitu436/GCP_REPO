{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-11-04T11:32:56.241006Z", "invocation_id": "c1ef0159-8379-46f8-91ed-911ef5fb0b99", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-04T11:32:53.466544Z", "completed_at": "2024-11-04T11:32:53.475734Z"}, {"name": "execute", "started_at": "2024-11-04T11:32:53.475734Z", "completed_at": "2024-11-04T11:32:56.226647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.7685067653656006, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "aad565fb-8fe7-488d-bd7e-c0c0de52d758", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_all_columns", "compiled": true, "compiled_code": "WITH source_data AS (\r\n    SELECT\r\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\r\n    FROM\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries\r\n),\r\n\r\nflatten_payload AS (\r\n    SELECT\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.ApplicationId\") AS ApplicationId,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\r\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.SubscriptionId\") AS SubscriptionId,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationType\") AS NotificationType,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationVersion\") AS NotificationVersion,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ItemCondition\") AS ItemCondition,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.MarketplaceId\") AS MarketplaceId,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.OfferChangeType\") AS OfferChangeType,\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.TimeOfOfferChange\") AS TimeOfOfferChange,\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\r\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,  -- Access the entire ListPrice object\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\r\n    FROM\r\n        source_data\r\n),\r\n\r\nflattened_payload AS (\r\n    SELECT\r\n        EventTime,\r\n        ApplicationId,\r\n        NotificationId,\r\n        PublishTime,\r\n        SubscriptionId,\r\n        NotificationType,\r\n        NotificationVersion,\r\n        ASIN,\r\n        ItemCondition,\r\n        MarketplaceId,\r\n        OfferChangeType,\r\n        TimeOfOfferChange,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsBuyBoxWinner\") AS BOOLEAN) AS IsBuyBoxWinner,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFeaturedMerchant\") AS BOOLEAN) AS IsFeaturedMerchant,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.IsFulfilledByAmazon\") AS BOOLEAN) AS IsFulfilledByAmazon,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.Amount\") AS FLOAT64) AS ListingPriceAmount,\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ListingPrice.CurrencyCode\") AS ListingPriceCurrencyCode,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferNationalPrime\") AS BOOLEAN) AS IsOfferNationalPrime,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.PrimeInformation.IsOfferPrime\") AS BOOLEAN) AS IsOfferPrime,\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.FeedbackCount\") AS INT64) AS SellerFeedbackCount,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.SellerFeedbackRating.SellerPositiveFeedbackRating\") AS INT64) AS SellerPositiveFeedbackRating,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.Shipping.Amount\") AS FLOAT64) AS ShippingAmount,\r\n        JSON_EXTRACT_SCALAR(offer, \"$.Shipping.CurrencyCode\") AS ShippingCurrencyCode,\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.AvailabilityType\") AS ShippingAvailabilityType,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MaximumHours\") AS INT64) AS ShippingMaxHours,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShippingTime.MinimumHours\") AS INT64) AS ShippingMinHours,\r\n        CAST(JSON_EXTRACT_SCALAR(offer, \"$.ShipsDomestically\") AS BOOLEAN) AS ShipsDomestically,\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.Country\") AS ShipsFromCountry,\r\n        JSON_EXTRACT_SCALAR(offer, \"$.ShipsFrom.State\") AS ShipsFromState,\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SubCondition\") AS SubCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\r\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\r\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\r\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\r\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\r\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\r\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\r\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\r\n\r\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\r\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\r\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\r\n\r\n    FROM\r\n        flatten_payload,\r\n        UNNEST(offers) AS offer,\r\n        UNNEST(bbp) AS bbp,\r\n        UNNEST(lop) AS lop,\r\n        UNNEST(neo) AS neo,\r\n        UNNEST(noo) AS noo,\r\n        UNNEST(sr) AS sr\r\n)\r\n\r\nSELECT *\r\nFROM flattened_payload", "relation_name": "`dbt-437212`.`wellbefore`.`dim_all_columns`"}], "elapsed_time": 6.802139520645142, "args": {"send_anonymous_usage_stats": true, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "partial_parse_file_diff": true, "static_parser": true, "log_level_file": "debug", "log_file_max_bytes": 10485760, "cache_selected_only": false, "macro_debugging": false, "project_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1", "require_resource_names_without_spaces": false, "full_refresh": true, "log_level": "info", "log_format": "default", "version_check": true, "profiles_dir": "C:\\Users\\SAILS-DM204\\.dbt", "invocation_command": "dbt run --full-refresh --select dim_all_columns", "quiet": false, "exclude": [], "which": "run", "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "log_format_file": "debug", "vars": {}, "enable_legacy_logger": false, "introspect": true, "write_json": true, "empty": false, "populate_cache": true, "strict_mode": false, "show_resource_report": false, "select": ["dim_all_columns"], "use_colors": true, "use_colors_file": true, "partial_parse": true, "log_path": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs", "print": true, "indirect_selection": "eager"}}