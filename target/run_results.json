{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-11-05T07:27:38.019729Z", "invocation_id": "50e40256-b18f-41a5-9474-cc12f6ea19ce", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-05T07:27:35.532183Z", "completed_at": "2024-11-05T07:27:35.532183Z"}, {"name": "execute", "started_at": "2024-11-05T07:27:35.532183Z", "completed_at": "2024-11-05T07:27:38.008367Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.476184606552124, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "dbt-437212", "job_id": "98332d0e-3158-43ac-bf2b-3e1b21e84214", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.buy_box_gcp_1.dim_summary_values", "compiled": true, "compiled_code": "WITH source_data AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT(MESSAGE_BODY, \"$\") AS raw_data\r\n\r\n    FROM\r\n\r\n        dbt-437212.wellbefore.BuyBox_raw_ds_first20_entries\r\n\r\n),\r\n\r\nflatten_payload AS (\r\n\r\n    SELECT\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.EventTime\") AS EventTime,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.NotificationId\") AS NotificationId,\r\n\r\n        TIMESTAMP(JSON_EXTRACT_SCALAR(raw_data, \"$.NotificationMetadata.PublishTime\")) AS PublishTime,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Offers\") AS offers,\r\n\r\n        JSON_EXTRACT_SCALAR(raw_data, \"$.Payload.AnyOfferChangedNotification.OfferChangeTrigger.ASIN\") AS ASIN,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.BuyBoxPrices\") AS bbp,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.LowestPrices\") AS lop,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfBuyBoxEligibleOffers\") AS neo,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.NumberOfOffers\") AS noo,\r\n\r\n        JSON_EXTRACT(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.ListPrice\") AS lp,\r\n\r\n        JSON_EXTRACT_ARRAY(raw_data, \"$.Payload.AnyOfferChangedNotification.Summary.SalesRankings\") AS sr\r\n\r\n    FROM\r\n\r\n        source_data\r\n\r\n),\r\n\r\nflattened_payload AS (\r\n\r\n    SELECT\r\n\r\n        EventTime,\r\n\r\n        NotificationId,\r\n\r\n        PublishTime,\r\n\r\n        ASIN,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Condition\") AS BuyBoxPricesCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(offer, \"$.SellerId\") AS SellerId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.Amount\") AS FLOAT64) AS BuyBoxLandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.LandedPrice.CurrencyCode\") AS BuyBoxLandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.Amount\") AS FLOAT64) AS BuyBoxListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.ListingPrice.CurrencyCode\") AS BuyBoxListingPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.Amount\") AS FLOAT64) AS BuyBoxShippingAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(bbp, \"$.Shipping.CurrencyCode\") AS BuyBoxShippingCurrencyCode,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Condition\") AS LowestPricesCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.FulfillmentChannel\") AS LowestPricesFulfillmentChannel,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.Amount\") AS FLOAT64) AS LandedPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.LandedPrice.CurrencyCode\") AS LandedPriceCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.Amount\") AS FLOAT64) AS LowestPricesListingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.ListingPrice.CurrencyCode\") AS LowestPricesListingCurrencyCode,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lop, \"$.Shipping.Amount\") AS FLOAT64) AS LowestPricesShippingPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lop, \"$.Shipping.CurrencyCode\") AS LowestPricesShippingCurrencyCode,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.Condition\") AS BuyBoxEligibleOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.FulfillmentChannel\") AS BuyBoxEligibleOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(neo, \"$.OfferCount\") AS BuyBoxEligibleOffersCount,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.Condition\") AS NumberOfOffersCondition,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.FulfillmentChannel\") AS NumberOfOffersFulfillmentChannel,\r\n\r\n        JSON_EXTRACT_SCALAR(noo, \"$.OfferCount\") AS NumberOfOffersCount,\r\n\r\n        JSON_EXTRACT_SCALAR(sr, \"$.ProductCategoryId\") AS SalesRankingsProductCategoryId,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(sr, \"$.Rank\") AS INT64) AS SalesRankingsRank,\r\n\r\n        CAST(JSON_EXTRACT_SCALAR(lp, \"$.Amount\") AS FLOAT64) AS ListPriceAmount,\r\n\r\n        JSON_EXTRACT_SCALAR(lp, \"$.CurrencyCode\") AS ListPriceCurrencyCode\r\n\r\n    FROM\r\n\r\n        flatten_payload,\r\n\r\n        UNNEST(offers) AS offer,\r\n\r\n        UNNEST(bbp) AS bbp,\r\n\r\n        UNNEST(lop) AS lop,\r\n\r\n        UNNEST(neo) AS neo,\r\n\r\n        UNNEST(noo) AS noo,\r\n\r\n        UNNEST(sr) AS sr\r\n\r\n)\r\n\r\nSELECT *\r\n\r\nFROM flattened_payload order by ASIN", "relation_name": "`dbt-437212`.`wellbefore`.`dim_summary_values`"}], "elapsed_time": 5.27179217338562, "args": {"show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt run --full-refresh --select dim_summary_values", "printer_width": 80, "use_colors_file": true, "static_parser": true, "favor_state": false, "enable_legacy_logger": false, "indirect_selection": "eager", "partial_parse": true, "introspect": true, "cache_selected_only": false, "log_level": "info", "use_colors": true, "exclude": [], "empty": false, "log_level_file": "debug", "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "quiet": false, "log_file_max_bytes": 10485760, "print": true, "project_dir": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1", "strict_mode": false, "macro_debugging": false, "partial_parse_file_diff": true, "version_check": true, "select": ["dim_summary_values"], "write_json": true, "log_path": "C:\\Users\\SAILS-DM204\\OneDrive - Sails Software Solutions Pvt Ltd\\Desktop\\Dummy Folder\\buy_box_gcp_1\\logs", "populate_cache": true, "log_format": "default", "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "full_refresh": true, "which": "run", "profiles_dir": "C:\\Users\\SAILS-DM204\\.dbt", "vars": {}, "log_format_file": "debug", "defer": false}}